<?xml version="1.0" encoding="utf-8"?>
<odoo>

        <record id="message_message_tree" model="ir.ui.view">
            <field name="name">message.message.tree</field>
            <field name="model">message.message</field>
            <field name="arch" type="xml">
                <tree string="Messages"
                    decoration-muted="state in ('sent', 'cancel')"
                    decoration-info="state=='outgoing'"
                    decoration-danger="state=='exception'" create="0" edit="0" delete="0">
                    <field name="date" />
                    <field name="name" />
                    <field name="to_number" />
                    <field name="author_id" string="User" />
                    <field name="message_id" invisible="1" />
                    <field name="model" invisible="1" />
                    <field name="res_id" invisible="1" />
                    <field name="state" />
                    <button name="action_send" string="Send Now" type="object"
                        icon="fa-paper-plane" states="outgoing" />
                    <button name="action_send" string="Retry" type="object"
                        icon="fa-repeat" states="exception,cancel"
                        context="{'from_retry': True}"/>
                    <button name="action_cancel" string="Cancel Email" type="object"
                        icon="fa-times" states="outgoing" />
                </tree>
            </field>
        </record>
    
        <record model="ir.ui.view" id="message_message_form">
            <field name="name">message.message.form</field>
            <field name="model">message.message</field>
            <field name="arch" type="xml">
                <form string="Messages" create="0" edit="0" delete="0">
                    <header>
                        <button name="action_send" type="object"
                            states="draft" string="Send" />
                        <button name="action_cancel" type="object"
                            states="draft,exception" string="Cancel" />
                        <button name="action_send" string="Retry" type="object"
                            states="exception" context="{'from_retry': True}" />
                        <field name="state" widget="statusbar"
                            statusbar_visible="draft,sent,exception,cancel" />
                    </header>
                    <sheet>
                        <group>
                            <group>
                                <field name="sms_template_id" string="Message Template"
                                    attrs="{'readonly': [('state','in', ('cancel','sent'))]}" />
                                <field name="name"
                                    attrs="{'readonly': [('state','in', ('cancel','sent'))]}" />
                                <field name="date"
                                    readonly="1" />
                                <field name="from_number"
                                    attrs="{'readonly': [('state','in', ('cancel','sent'))]}" />
                                <field name="author_id" string="User" readonly="1"
                                    attrs="{'readonly': [('state','in', ('cancel','sent'))]}" />
                                <field name="partner_ids" widget="many2many_tags"
                                    attrs="{'readonly': [('state','in', ('cancel','sent'))]}" />
                            </group>
                            <group>
                                <field name="model"
                                    readonly="1" />
                                <field name="to_number"
                                    attrs="{'readonly': [('state','in', ('cancel','sent'))]}" />
                                <field name="reply_to"
                                    attrs="{'readonly': [('state','in', ('cancel','sent'))]}" />
                                <field name="res_id" readonly="1" />
                            </group>
                        </group>
                        <notebook>
                            <page string="Message">
                                <field name="message"
                                    attrs="{'readonly': [('state','in', ('cancel','sent'))]}" />
                            </page>
                            <page string="Gateway">
                                <group>
                                    <group>
                                        <field name="message_id" readonly="1" />
                                        <field name="sms_server_id"
                                            attrs="{'readonly': [('state','in', ('cancel','sent'))]}" />
                                    </group>
                                </group>
                            </page>
                            <page string="Failure Reason"
                                attrs="{'invisible': [('state', '!=', 'exception')]}">
                                <field name="failure_reason"
                                    attrs="{'readonly': [('state','in', ('cancel','sent'))]}" />
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>
    
        <record id="action_messages" model="ir.actions.act_window">
            <field name="name">Messages</field>
            <field name="res_model">message.message</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="message_message_tree" />
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to add a Messages.
                </p>
            </field>
        </record>
    
        <menuitem action="action_messages"
            id="menu_action_messages_tree" parent="bista_sms_global.menu_sms"
            sequence="3" />

</odoo>
